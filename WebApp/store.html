<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Knockout Store</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="style.css" media="screen">
</head>
<body>

<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js'></script>
<script type='text/javascript' src='scripts/KnockoutJavascript.js'></script>

<div id="container"> 

  <div id="header">
    <div class="headtitle">Knockout Store</div>
  </div>

  <div id="menu"> 
    <ul>
      <li><a href="index.html#" title="">HOME</a></li>
      <li><a href="store.html#" title="">STORE</a></li>
    </ul>
  </div>


  <div id="content"> 

    <div id="insidecontent"> <br>
      <h1>Store</h1>
      <ul data-bind="foreach: products">
        <li>
            <h1><span data-bind="text: displayName"></span></h1>
            <span data-bind="text: description"></span><br>
            <img width="100px" height="100px" data-bind="attr:{src: primaryFullImageUrl}"/><br>  
            <p>List Price: <span data-bind="text: listPrice"></span></p>
            <p>Sale Price: <span data-bind="text: salePrice"></span></p>
        </li>
        <button data-bind="click: $root.addProductToCart">Add To Cart</button>
      </ul>
      <h1>Cart Items</h1>
      <ul data-bind="foreach: cart">
        <li>
            <p>
              <span data-bind="text: displayName"></span>
            </p>
        </li>
      </ul>
      <h3 data-bind="visible: cartTotal() > 0">
        Cart Total: $<span data-bind="text: cartTotal().toFixed(2)"/>
      </h3>
     
    </div>

    

    <div style="clear: both;"></div>

  </div>



  <div id="footer"> <span>Copyright Â© 2016 | All Rights Reserved  </span> 
  </div>

</div>
</body>
</html>




<script>
function Product(displayName,description,id,listPrice,salePrice,primaryFullImageUrl) {
	this.displayName = ko.observable(displayName);
  this.description = ko.observable(description);
  this.id = ko.observable(id);
  this.listPrice = listPrice;
  this.salePrice = salePrice;
  this.primaryFullImageUrl = ko.observable(primaryFullImageUrl);
};
function productViewModel() {
  var self = this;
  self.products = ko.observableArray();

  self.cart = ko.observableArray();
  self.addProductToCart = function(product) {
      self.cart.push(product)
  } 
  self.cartTotal = ko.computed(function() {
  		var total = 0;
			for(var i = 0; i < self.cart().length; i++) {
      		total += self.cart()[i].salePrice;
      }
      return total;
  });
  $.getJSON("https://crossorigin.me/https://ccstore-z5ia.oracleoutsourcing.com/ccstoreui/v1/products?totalResults=true&totalExpandedResults=true&catalogId=&offset=0&limit=60&categoryId=HomePageFeatured&includeChildren=true&storePriceListGroupId=defaultPriceGroup", function(json) {
    var jsonData = JSON.stringify(json);
    var items = json.items;
    for(var i = 0; i < items.length; i += 1) {
      var imageUrl = "https://ccstore-z5ia.oracleoutsourcing.com" + items[i].primaryFullImageURL;
      self.products.push(new Product(items[i].displayName, items[i].description, items[i].id, items[i].listPrice,items[i].salePrice, imageUrl));
    }
});
}
ko.applyBindings(new productViewModel());
</script>

